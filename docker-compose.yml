services:
  # -----------------------------------------------------------------
  # 1. 백엔드 서비스 (Django + Gunicorn with Reload)
  # -----------------------------------------------------------------
  backend:
    # 빌드 컨텍스트: docker-compose.yml 파일이 있는 현재 위치(.)를 지정
    build: 
      context: .
      dockerfile: Dockerfile
    
    # Gunicorn 실행 명령 (코드 변경 감지 --reload 포함)
    command: gunicorn myproject.wsgi:application --bind 0.0.0.0:8000 --reload --timeout 120 

    # 포트 포워딩: 호스트 8080 -> 컨테이너 8000
    ports:
      - "8080:8000"
      
    # 환경 변수 파일: 현재 위치의 .env 파일 지정
    env_file:
      - ./.env
      
    # 볼륨 마운트: 현재 디렉토리(.)를 컨테이너의 /app으로 연결
    volumes:
      - ./:/app
      # 아래 줄은 ./:/app에 이미 포함되므로 굳이 따로 적지 않아도 되지만, 
      # 명시적으로 특정 폴더를 강조하고 싶다면 유지해도 됩니다. 
      # 다만 경로는 ./my_fake_news_model 로 수정해야 합니다.
      - ./my_fake_news_model:/app/my_fake_news_model
      
    container_name: info_mate_backend
    restart: always